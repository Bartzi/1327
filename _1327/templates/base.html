{% extends "master.html" %}
{% load i18n %}
{% load static %}
{% load bootstrap3 %}

{% block body %}
<div class="container main-container" id="wrapper">
	<header>
		<nav class="navbar navbar-default" role="navigation">
			
			{# Toggle button #}
			<div class="navbar-header">
				<a class="navbar-toggle-brand navbar-toggle collapsed" href="{% url 'main.views.index' %}"><img src="{% get_static_prefix %}/images/logo-fsr-color.svg"></a>
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>

			{# Main menu (for wider screens) #}
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li class="brand">
						<a class="navbar-brand" href="/"><img src="{% get_static_prefix %}/images/logo-fsr-color.svg"></a>
					</li>
					{% for item in main_menu %}
						{% if item.submenu %}
							<li class="dropdown{% if item.selected %} active{% endif %}">
								<a href="{{ item.get_url }}">{{ item.title }} <span class="caret"></span></a>
								<ul class="dropdown-menu">
									{% for subitem in item.submenu %}
										<li{% if subitem.selected %} class="active"{% endif %}><a href="{{ subitem.get_url }}">{{ subitem.title }}</a></li>
									{% endfor %}
								</ul>
							</li>
						{% else %}
							<li{% if item.selected %} class="active"{% endif %}>
								<a href="{{ item.get_url }}">{{ item.title }}</a>
							</li>
						{% endif %}
					{% endfor %}
					<li class="dropdown pull-right{% if user.is_authenticated %} active{% endif %}">
						<a href="#"><span class="glyphicon glyphicon-user"></span></a>
						<ul class="dropdown-menu">
							{% if user.is_authenticated %}
								<li class="disabled"><a href="#">{% trans "Logged in as" %} {{ user.username }}</a></li>
								<li><a href="{% url 'user_management.views.logout' %}">Logout</a></li>
							{% else %}
								<li><a href="{% url 'user_management.views.login' %}">Login</a></li>
							{% endif %}
							{% if CAN_CREATE_INFORMATIONPAGE %}
								<li role="separator" class="divider"></li>
								<li class="disabled"><a href="#">{% trans "Create content" %}</a></li>
								<li><a href="{% url 'information_pages:create' %}">{% trans "Information page" %}</a></li>
								<li><a href="{% url 'minutes:create' %}">{% trans "Minutes" %}</a></li>
							{% endif %}
						</ul>
					</li>
				</ul>
			</div>
			
			{# Toggle menu (for smaller screens) #}
			<div class="navbar-collapse-menu" id="navbar-collapse" aria-expanded="false">
				<ul class="">
					{% if user.is_authenticated %}
						<li class="disabled"><a href="#" disabled>{% trans "Logged in as" %} {{ user.username }}</a></li>
						<ul><li><a href="{% url 'user_management.views.logout' %}">Logout</a></li></ul>
					{% else %}
						<li><a href="{% url 'user_management.views.login' %}">Login</a></li>
					{% endif %}
					{% if CAN_CREATE_INFORMATIONPAGE %}
						<li class="disabled"><a href="#" disabled>{% trans "Create content" %}</a></li>
						<ul>
							<li><a href="{% url 'information_pages:create' %}">{% trans "Information page" %}</a></li>
							<li><a href="{% url 'minutes:create' %}">{% trans "Minutes" %}</a></li>
						</ul>
					{% endif %}
					<li><a href="/">{% trans "Main page" %}</a></li>
					{% for item in main_menu %}
						{% if item.submenu %}
							<li class="{% if item.selected %}active{% endif %}"><a href="{{ item.get_url }}">{{ item.title }}</a></li>
							<ul>
								{% for subitem in item.submenu %}
									<li{% if subitem.selected %} class="active"{% endif %}><a href="{{ subitem.get_url }}">{{ subitem.title }}</a></li>
								{% endfor %}
							</ul>
						{% else %}
							<li{% if item.selected %} class="active"{% endif %}>
								<a href="{{ item.get_url }}">{{ item.title }}</a>
							</li>
						{% endif %}
					{% endfor %}
				</ul>
			</div>
		</nav>
		<div class="header-line gradient"></div> {# Gradient line #}
		<div class="header-line"></div> {# Bottom line for menu #}
	</header>

	{% if messages %}
	<div class="container messages">
		{% bootstrap_messages %}
	</div>
	{% endif %}

	{% block rawcontent %}
	<div class="headline">
		<svg height="60" width="100%">
			<defs>
				<filter id="shadow" width="200%" height="200%">
					<feOffset result="offOut" in="SourceGraphic" dx="3" dy="5"></feOffset>
					<feGaussianBlur result="blurOut" in="offOut" stdDeviation="3"></feGaussianBlur>
				</filter>
			</defs>
			<polygon class="headline-bar-shadow" filter="url(#shadow)"></polygon>
			<polygon class="headline-bar"></polygon>
			<text class="headline-text" dx="30" dy="25">{% block title %}{% endblock %}</text>
		</svg>
	</div>
	{% endblock %}

	<footer>
		<div class="footer-line"></div> {# Top line for footer #}
		<div class="footer-line gradient gradient-inv"></div> {# Gradient line #}
		<div class="container">
			<span class="pull-left">
				<ul>
					{% for item in footer %}
						<li><a href="{{ item.get_url }}">{{ item.title }}</a></li>
					{% endfor %}
				</ul>
			</span>
			<span class="pull-right">Powered by <a href="https://github.com/fsr-itse/1327">1327</a>.</span>
		</div>
	</footer>
</div>
{% endblock %}


{% block scripts %}
	{{ block.super }}

	<script type="text/javascript">
		$(document).ready(function() {
			// resize headline bar to fit the text
			var l = $('.headline-text')[0].getComputedTextLength() + 50;
			var points = "-10,0 " + (l+18) + ",0 " + l + ",50 -10,50";
			$('.headline-bar')[0].setAttribute('points', points);
			$('.headline-bar-shadow')[0].setAttribute('points', points);
			$('[data-toggle="tooltip"]').tooltip();
		});
	</script>
{% endblock %}
